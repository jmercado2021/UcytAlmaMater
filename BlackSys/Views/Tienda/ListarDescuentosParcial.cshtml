@model List<BlackSys.Models.W_SelectArticulosDescuento_Result>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    @*Neccesarios para Exportar Js*@
    <script src="~/assets/js/popper.min.js"></script>
    <link href="~/assets/Exportar Js/tableexport.css" rel="stylesheet" />
    <link href="~/Content/DynaTables/jquery.dynatable.css" rel="stylesheet" />
    <script src="~/Content/DynaTables/jquery.dynatable.js"></script>

    <script src="~/Content/DynaTables/jquery.dynatableSinBuscador.js"></script>
    <script src="~/Content/ScripByron/DescuentoArticulo.js"></script>
    <script type="text/javascript" src="https://unpkg.com/xlsx@0.14.1/dist/xlsx.full.min.js"></script>
</head>
<div id="wrapper">

    <input type="file" id="input-excel" />
</div>
@*<button type="button" onclick="cargar()">Cargar</button>*@




<table id='my_file_output'></table>
<button type="button" onclick="RecorrerTabla">Recorrero</button>
<div class="row">
    <div class="col-md-12">
        @* <input id="buscar" type="text" class="form-control" placeholder="Escriba algo para filtrar" />*@
        <table class="table table-striped table-bordered table-hover dt-responsive" id="my-tableDino23" cellspacing="0">
            <thead>
                <tr>
                    <th>Consecutivo</th>
                    <th>Codigo</th>
                    <th>Descripcion</th>
                    <th>Descuento porcentaje</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)
                {
                    <tr>
                        @*<td class="numero">@Html.DisplayFor(modelItem => item.Id)</td>*@
                        <td class="numero">@Html.DisplayFor(modelItem => item.CONSECUTIVO)</td>
                        <td class="numero">@Html.DisplayFor(modelItem => item.ARTICULO_ID)</td>
                        <td class="numero">@Html.DisplayFor(modelItem => item.ArticuloNombre)</td>
                        <td class="numero">@Html.DisplayFor(modelItem => item.Descuento_Porcentaje)</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>
<script>
    document.querySelector("#buscar").onkeyup = function () {
        $TableFilter("#sys-table", this.value);
    }

    $TableFilter = function (id, value) {
        var rows = document.querySelectorAll(id + ' tbody tr');

        for (var i = 0; i < rows.length; i++) {
            var showRow = false;

            var row = rows[i];
            row.style.display = 'none';

            for (var x = 0; x < row.childElementCount; x++) {
                if (row.children[x].textContent.toLowerCase().indexOf(value.toLowerCase().trim()) > -1) {
                    showRow = true;
                    break;
                }
            }

            if (showRow) {
                row.style.display = null;
            }
        }
    }


</script>
<style>
    .loader {
        position: fixed;
        left: 0px;
        top: 0px;
        width: 100%;
        height: 100%;
        z-index: 9999;
        background: url('images/pageLoader.gif') 50% 50% no-repeat rgb(249,249,249);
        opacity: .8;
    }
</style>

<script type="text/javascript">
    $(window).load(function () {
        $(".loader").fadeOut("slow");
    });
</script>


<script>
    document.querySelector("#buscar").onkeyup = function () {
        $TableFilter("#my-tableDino23", this.value);
    }

    $TableFilter = function (id, value) {
        var rows = document.querySelectorAll(id + ' tbody tr');

        for (var i = 0; i < rows.length; i++) {
            var showRow = false;

            var row = rows[i];
            row.style.display = 'none';

            for (var x = 0; x < row.childElementCount; x++) {
                if (row.children[x].textContent.toLowerCase().indexOf(value.toLowerCase().trim()) > -1) {
                    showRow = true;
                    break;
                }
            }

            if (showRow) {
                row.style.display = null;
            }
        }
    }
</script>

<script>

    $('#my-tableDino23').dynatable({
        table: {
            defaultColumnIdStyle: 'dashed'
        }
    });


</script>
<style>
    .loader {
        position: fixed;
        left: 0px;
        top: 0px;
        width: 100%;
        height: 100%;
        z-index: 9999;
        background: url('images/pageLoader.gif') 50% 50% no-repeat rgb(249,249,249);
        opacity: .8;
    }
</style>

<script type="text/javascript">
    $(window).load(function () {
        $(".loader").fadeOut("slow");
    });
</script>

<script>
    $('#input-excel').change(function (e) {
        var reader = new FileReader();
        reader.readAsArrayBuffer(e.target.files[0]);
        reader.onload = function (e) {
            var data = new Uint8Array(reader.result);
            var wb = XLSX.read(data, { type: 'array' });
            var htmlstr = XLSX.write(wb, { sheet: "sheet no1", type: 'binary', bookType: 'html' });
            $('#wrapper')[0].innerHTML += htmlstr;
        }
    });
</script>

